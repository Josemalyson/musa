<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE HTML>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/template/template.xhtml">

	<ui:define name="conteudo">

		<ol class="breadcrumb">
			<li><a href="#" class="disabled">Inicio</a></li>
			<li><a href="#" class="disabled">Pedido</a></li>
			<li><a href="#" class="active">Emitir Pedido</a></li>
		</ol>

		<h:form prependId="false" id="pedido">

			<h2>Pedido</h2>

			<div class="panel panel-default" style="width: 50%;">
				<div class="panel-body row">
					<div class="col-sm-4">
						<label class="control-label">Número do Pedido:</label>
						<h:outputText value="123" />
					</div>
					<div class="col-sm-8">
						<label class="control-label"> Data do Pedido: </label>
						<h:outputText
							value="#{pedidoControlador.pedidoVO.pedido.dtPedido}">
							<f:convertDateTime pattern="dd/MM/yyyy" />
						</h:outputText>
					</div>
				</div>
			</div>


			<div id="cliente">
				<fieldset>
					<legend>Cliente</legend>
					<div class="panel-body row">
						<div class="col-sm-4">
							<label class="control-label espacamento10PxDireita ">Nome
								Cliente:</label>
							<p:autoComplete id="clienteId"
								completeMethod="#{pedidoControlador.autoCompleteCliente}"
								converter="entityConverter"
								value="#{pedidoControlador.pedidoVO.cliente}" dropdown="true"
								forceSelection="true" var="cliente" itemValue="#{cliente}"
								itemLabel="#{cliente.nome}">
								<p:ajax update="cpf" event="itemSelect"
									listener="#{pedidoControlador.atualizarCliente()}" />
							</p:autoComplete>
						</div>
						<div class="col-sm-4">
							<label class="control-label espacamento10PxDireita ">CPF:
							</label>
							<h:outputText id="cpf"
								value="#{pedidoControlador.pedidoVO.cliente.cpf}" />
						</div>
					</div>
				</fieldset>
			</div>

			<fieldset>
				<legend>Lista de Produtos</legend>

				<p:dataTable var="produtoVO" id="tabelaProdutoVO"
					value="#{pedidoControlador.pedidoVO.produtoVOList}">

					<p:column headerText="Quantidade">
						<h:inputText id="quantidadeId"
							value="#{produtoVO.quantidadeProduto}" converterMessage="Digite um número válido.">
							<f:convertNumber type="number" maxIntegerDigits="9" groupingUsed="false" />
						</h:inputText >
					</p:column>

					<p:column headerText="Descrição Produto">
						<h:selectOneMenu id="produtoID"
							styleClass="width full form-control" value="#{produtoVO.produto}"
							converter="genericConverter">
							<f:selectItem itemLabel="Selecione um produto"
								noSelectionOption="true" itemDisabled="true" />
							<f:selectItems value="#{pedidoControlador.produtoList}"
								var="produto" itemLabel="#{produto.descricaoProduto}"
								itemValue="#{produto}" />
							<p:ajax listener="#{pedidoControlador.adicionarProduto()}"
								update="tabelaProdutoVO" process="produtoID quantidadeId" />
						</h:selectOneMenu>

					</p:column>

					<p:column headerText="Preço de Custo">
						<h:outputText value="#{produtoVO.produto.precoCusto}">
							<f:convertNumber currencySymbol="R$" groupingUsed="true"
								maxFractionDigits="2" type="currency" locale="pt_BR" />
						</h:outputText>
					</p:column>
					<p:column headerText="Preço de Venda">
						<h:outputText value="#{produtoVO.produto.precoVenda}">
							<f:convertNumber currencySymbol="R$" groupingUsed="true"
								maxFractionDigits="2" type="currency" locale="pt_BR" />
						</h:outputText>
					</p:column>

					<p:columnGroup type="footer">
						<p:row>
							<p:column colspan="2" style="text-align:right" footerText="Total" />
							<p:column footerText="#{pedidoControlador.pedidoVO.totalCusto}"  />
							<p:column footerText="#{pedidoControlador.pedidoVO.totalVenda}"  />
						</p:row>
					</p:columnGroup>
				</p:dataTable>

			</fieldset>

			<div class="espacamento20Px" />

			<p class="obrigatorio">Campos Obrigatórios</p>

		</h:form>
	</ui:define>

</ui:composition>