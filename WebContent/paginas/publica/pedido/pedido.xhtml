<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE HTML>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/template/template.xhtml">

	<ui:define name="conteudo">

		<ol class="breadcrumb">
			<li><a href="#" class="disabled">Inicio</a></li>
			<li><a href="#" class="disabled">Pedido</a></li>
			<li><a href="#" class="active">Emitir Pedido</a></li>
		</ol>

		<h:form prependId="false" id="pedido">

			<h2>Pedido</h2>

			<div class="panel panel-default">
				<div class="panel-body row">
					<div class="col-sm-2">
						<label class="control-label espacamento10PxDireita">Número
							do Pedido:</label>
						<h:outputText value="#{pedidoControlador.pedidoVO.numeroPedido}" />
					</div>

					<div class="col-sm-3">
						<label class="control-label espacamento10PxDireita"> Data
							do Pedido: </label>
						<h:outputText
							value="#{pedidoControlador.pedidoVO.pedido.dtPedido}">
							<f:convertDateTime pattern="dd/MM/yyyy" />
						</h:outputText>
					</div>

					<div class="col-sm-7">
						<label class="control-label espacamento10PxDireita">Tipo
							do Pedido: </label>
						<p:selectOneRadio id="tipoPedidoId"
							value="#{pedidoControlador.pedidoVO.pedido.tipoPedido}"
							styleClass="checkbox-inline" converter="genericConverter">
							<p:ajax update="tipoPedidoId" />
							<f:selectItems value="#{pedidoControlador.tipoPedidoList}"
								var="tipoPedido" itemLabel="#{tipoPedido.descricao}"
								itemValue="#{tipoPedido}" />
						</p:selectOneRadio>
					</div>
				</div>
			</div>


			<div id="cliente">
				<fieldset>
					<legend>Cliente</legend>
					<div class="panel-body row">
						<div class="col-sm-4">
							<label class="control-label espacamento10PxDireita ">Nome
								Cliente:</label>
							<p:autoComplete id="clienteId"
								completeMethod="#{pedidoControlador.autoCompleteCliente}"
								converter="entityConverter"
								value="#{pedidoControlador.pedidoVO.cliente}" dropdown="true"
								forceSelection="true" var="cliente" itemValue="#{cliente}"
								itemLabel="#{cliente.nome}">
								<p:ajax update="cpf" event="itemSelect"
									listener="#{pedidoControlador.atualizarCliente()}" />
							</p:autoComplete>
						</div>
						<div class="col-sm-4">
							<label class="control-label espacamento10PxDireita ">CPF:
							</label>
							<p:inputText id="cpf" disabled="true"
								value="#{pedidoControlador.pedidoVO.cliente.cpf}" />
						</div>
					</div>
				</fieldset>
			</div>

			<div class="text-right">
				<p:commandButton id="btAdicionarProduto" value="Adiconar Produto"
					styleClass="btn btn-success btn-sm"
					actionListener="#{pedidoControlador.adicionarProduto()}"
					disabled="#{pedidoControlador.flBotaoAdicionarPedido}"
					update="tabelaProdutoVO btAdicionarProduto">
					<f:actionListener
						binding="#{pedidoControlador.setFlBotaoAdicionarPedido(true)}" />
				</p:commandButton>
			</div>


			<fieldset>
				<legend>Lista de Produtos</legend>

				<div class="espacamento20Px" />

				<p:dataTable var="produtoVO" id="tabelaProdutoVO"
					emptyMessage="Sem produtos"
					value="#{pedidoControlador.pedidoVO.produtoVOList}"
					tableStyleClass="table table-hover" paginator="true"
					paginatorAlwaysVisible="true" pageLinks="10" rows="10"
					rowsPerPageTemplate="10,30,50" paginatorPosition="bottom">

					<p:column headerText="Quantidade">
						<h:inputText id="quantidadeId" styleClass="text-center"
							style="margin-left: 62px;" value="#{produtoVO.quantidadeProduto}"
							converterMessage="Digite um número válido." size="2">
							<p:ajax listener="#{pedidoControlador.ajustarTela(produtoVO)}"
								event="keyup" process="tabelaProdutoVO" />
							<f:convertNumber type="number" maxIntegerDigits="9"
								groupingUsed="false" />
						</h:inputText>
					</p:column>

					<p:column headerText="Descrição Produto">
						<h:selectOneMenu id="produtoID"
							styleClass="width full form-control" value="#{produtoVO.produto}"
							converter="genericConverter">
							<f:selectItem itemLabel="Selecione um produto"
								noSelectionOption="true" itemDisabled="true" />
							<f:selectItems value="#{pedidoControlador.produtoList}"
								var="produto"
								itemLabel="#{produto.descricaoProduto.toUpperCase()}"
								itemValue="#{produto}" />
							<p:ajax listener="#{pedidoControlador.ajustarTela(produtoVO)}"
								process="tabelaProdutoVO" />
						</h:selectOneMenu>
					</p:column>


					<p:column headerText="Preço de Custo" styleClass="text-right">
						<h:outputText value="#{produtoVO.produto.precoCusto}">
							<f:convertNumber currencySymbol="R$" groupingUsed="true"
								maxFractionDigits="2" type="currency" locale="pt_BR" />
						</h:outputText>
					</p:column>

					<p:column headerText="Preço Total de Custo" styleClass="text-right">
						<h:outputText
							value="#{produtoVO.produto.precoCusto * produtoVO.quantidadeProduto}">
							<f:convertNumber currencySymbol="R$" groupingUsed="true"
								maxFractionDigits="2" type="currency" locale="pt_BR" />
						</h:outputText>
					</p:column>

					<p:column headerText="Preço de Venda" styleClass="text-right">
						<h:outputText value="#{produtoVO.produto.precoVenda}">
							<f:convertNumber currencySymbol="R$" groupingUsed="true"
								maxFractionDigits="2" type="currency" locale="pt_BR" />
						</h:outputText>
					</p:column>

					<p:column headerText="Preço Total de Venda" styleClass="text-right">
						<h:outputText
							value="#{produtoVO.produto.precoVenda * produtoVO.quantidadeProduto}">
							<f:convertNumber currencySymbol="R$" groupingUsed="true"
								maxFractionDigits="2" type="currency" locale="pt_BR" />
						</h:outputText>
					</p:column>

					<p:columnGroup type="footer">
						<p:row>
							<p:column colspan="3" style="text-align:right">
								<f:facet name="footer">
									<strong> <h:outputText value="Totais" />
									</strong>
								</f:facet>
							</p:column>


							<p:column style="text-align:right">
								<f:facet name="footer">
									<strong> <h:outputText
											value="#{pedidoControlador.pedidoVO.pedido.nuTotalCusto}">
											<f:convertNumber currencySymbol="R$" groupingUsed="true"
												maxFractionDigits="2" type="currency" locale="pt_BR" />
										</h:outputText>
									</strong>
								</f:facet>
							</p:column>

							<p:column footerText="----" />


							<p:column style="text-align:right">
								<f:facet name="footer">
									<strong> <h:outputText
											value="#{pedidoControlador.pedidoVO.pedido.nuTotalVenda}">
											<f:convertNumber currencySymbol="R$" groupingUsed="true"
												maxFractionDigits="2" type="currency" locale="pt_BR" />
										</h:outputText>
									</strong>
								</f:facet>
							</p:column>

						</p:row>
					</p:columnGroup>
				</p:dataTable>
			</fieldset>

			<div class="espacamento20Px" />

			<div class="form-inline row botoesSalvarCancelar">
				<div class="form-group">
					<label class="col-sm-2 control-label"></label>
					<div class="col-sm-2">
						<p:commandButton id="btSalvar" value="Salvar"
							styleClass="btn btn-success btn-sm"
							action="#{pedidoControlador.salvarPedido()}" />
					</div>
					<label class="col-sm-2 control-label"></label>
					<div class="col-sm-2">
						<p:commandButton value="Cancelar"
							styleClass="btn btn-danger btn-sm" />
					</div>
				</div>
			</div>

			<div class="espacamento20Px" />

			<p class="obrigatorio">Campos Obrigatórios</p>
		</h:form>
	</ui:define>

</ui:composition>